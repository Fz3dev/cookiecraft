{"version":3,"file":"cookiecraft.min.js","sources":["../src/core/ConsentManager.ts","../src/core/StorageManager.ts","../src/core/EventEmitter.ts","../src/blocking/ScriptBlocker.ts","../src/blocking/CategoryManager.ts","../src/ui/Banner.ts","../src/ui/PreferenceCenter.ts","../src/ui/FloatingWidget.ts","../src/integrations/GTMConsentMode.ts","../src/integrations/DataLayerManager.ts","../src/core/CookieConsent.ts"],"sourcesContent":["/**\n * ConsentManager - Handles consent logic and validation\n */\n\nimport { ConsentConfig, ConsentCategories, ConsentRecord } from '../types';\n\nexport class ConsentManager {\n  private consent!: ConsentRecord;\n  private config: ConsentConfig;\n\n  constructor(config: ConsentConfig) {\n    this.config = config;\n  }\n\n  /**\n   * Validate consent categories\n   */\n  public validateConsent(categories: ConsentCategories): boolean {\n    // Necessary cookies must always be enabled\n    if (!categories.necessary) {\n      return false;\n    }\n\n    // Validate against config\n    for (const key of Object.keys(categories)) {\n      if (!(key in this.config.categories)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Update consent with new categories\n   */\n  public updateConsent(categories: ConsentCategories): ConsentRecord {\n    if (!this.validateConsent(categories)) {\n      throw new Error('Invalid consent categories');\n    }\n\n    this.consent = this.createConsentRecord(categories);\n    return this.consent;\n  }\n\n  /**\n   * Check if user needs to give consent\n   */\n  public needsConsent(): boolean {\n    return this.consent === undefined;\n  }\n\n  /**\n   * Check if stored consent needs update due to policy change\n   */\n  public needsUpdate(storedConsent: ConsentRecord): boolean {\n    // Check if policy version has changed\n    return storedConsent.version < this.config.revision;\n  }\n\n  /**\n   * Get current consent record\n   */\n  public getCurrentConsent(): ConsentRecord {\n    return this.consent;\n  }\n\n  /**\n   * Create a new consent record\n   */\n  private createConsentRecord(categories: ConsentCategories): ConsentRecord {\n    const now = new Date();\n    const expiryDate = new Date(now);\n    expiryDate.setMonth(expiryDate.getMonth() + 13); // 13 months per GDPR\n\n    return {\n      version: this.config.revision,\n      timestamp: now.toISOString(),\n      categories: { ...categories },\n      userAgent: navigator.userAgent,\n      expiresAt: expiryDate.toISOString(),\n    };\n  }\n}\n","/**\n * StorageManager - Manages localStorage persistence for consent records\n */\n\nimport { ConsentRecord } from '../types';\n\nexport class StorageManager {\n  private static readonly STORAGE_KEY = 'cookiecraft_consent';\n  private static readonly EXPIRY_MONTHS = 13;\n\n  /**\n   * Save consent record to localStorage\n   */\n  public save(consent: ConsentRecord): void {\n    try {\n      localStorage.setItem(\n        StorageManager.STORAGE_KEY,\n        JSON.stringify(consent)\n      );\n    } catch (e) {\n      console.error('Failed to save consent:', e);\n    }\n  }\n\n  /**\n   * Load consent record from localStorage\n   */\n  public load(): ConsentRecord | null {\n    try {\n      const data = localStorage.getItem(StorageManager.STORAGE_KEY);\n      if (!data) return null;\n\n      const parsed = JSON.parse(data);\n\n      // Validate schema\n      if (!this.validateSchema(parsed)) {\n        // Try migration\n        const migrated = this.migrate(parsed);\n        if (migrated) {\n          this.save(migrated);\n          return migrated;\n        }\n        return null;\n      }\n\n      return parsed;\n    } catch (e) {\n      console.error('Failed to load consent:', e);\n      return null;\n    }\n  }\n\n  /**\n   * Clear consent record from localStorage\n   */\n  public clear(): void {\n    localStorage.removeItem(StorageManager.STORAGE_KEY);\n  }\n\n  /**\n   * Check if consent record has expired\n   */\n  public isExpired(consent: ConsentRecord): boolean {\n    const expiry = new Date(consent.expiresAt);\n    return expiry < new Date();\n  }\n\n  /**\n   * Validate consent record schema\n   */\n  private validateSchema(data: any): boolean {\n    return (\n      data &&\n      typeof data.version === 'number' &&\n      typeof data.timestamp === 'string' &&\n      typeof data.categories === 'object' &&\n      typeof data.userAgent === 'string' &&\n      typeof data.expiresAt === 'string'\n    );\n  }\n\n  /**\n   * Migrate old consent format to new format\n   * Returns null if migration fails\n   */\n  private migrate(oldData: any): ConsentRecord | null {\n    // Handle migration from older versions\n    // For v1, no migration needed - just return null\n    return null;\n  }\n}\n","/**\n * EventEmitter - Simple pub/sub pattern for internal and external events\n */\n\nexport class EventEmitter {\n  private events: Map<string, Set<Function>> = new Map();\n\n  /**\n   * Register an event handler\n   */\n  public on(event: string, callback: Function): void {\n    if (!this.events.has(event)) {\n      this.events.set(event, new Set());\n    }\n    this.events.get(event)!.add(callback);\n  }\n\n  /**\n   * Unregister an event handler\n   */\n  public off(event: string, callback: Function): void {\n    if (this.events.has(event)) {\n      this.events.get(event)!.delete(callback);\n    }\n  }\n\n  /**\n   * Emit an event with optional data\n   */\n  public emit(event: string, data?: any): void {\n    if (this.events.has(event)) {\n      this.events.get(event)!.forEach((callback) => {\n        try {\n          callback(data);\n        } catch (e) {\n          console.error(`Error in event handler for ${event}:`, e);\n        }\n      });\n    }\n  }\n\n  /**\n   * Clear all event handlers\n   */\n  public clear(): void {\n    this.events.clear();\n  }\n\n  /**\n   * Clear handlers for a specific event\n   */\n  public clearEvent(event: string): void {\n    this.events.delete(event);\n  }\n}\n","/**\n * ScriptBlocker - Prevents scripts from executing before consent using MutationObserver\n */\n\nimport { ConsentCategories } from '../types';\nimport { CategoryManager } from './CategoryManager';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class ScriptBlocker {\n  private observer: MutationObserver | null = null;\n  private blockedScripts: Map<string, HTMLScriptElement> = new Map();\n  private categoryManager: CategoryManager;\n  private eventEmitter: EventEmitter;\n  private currentConsent: ConsentCategories | null = null;\n\n  constructor(categoryManager: CategoryManager, eventEmitter: EventEmitter) {\n    this.categoryManager = categoryManager;\n    this.eventEmitter = eventEmitter;\n  }\n\n  /**\n   * Initialize script blocking\n   */\n  public init(): void {\n    // Block all existing scripts\n    this.blockExistingScripts();\n\n    // Watch for dynamically added scripts (GTM, etc.)\n    this.observeDOM();\n  }\n\n  /**\n   * Block all scripts (reset consent)\n   */\n  public block(): void {\n    this.currentConsent = null;\n    this.blockExistingScripts();\n  }\n\n  /**\n   * Unblock scripts based on consent categories\n   */\n  public unblock(categories: ConsentCategories): void {\n    this.currentConsent = categories;\n\n    // Reactivate blocked scripts based on consent\n    this.blockedScripts.forEach((script, id) => {\n      const category = this.categoryManager.getCategoryForScript(script);\n      if (category && this.categoryManager.isAllowed(category, categories)) {\n        this.reactivateScript(script);\n        this.blockedScripts.delete(id);\n      }\n    });\n  }\n\n  /**\n   * Destroy the blocker and stop observing\n   */\n  public destroy(): void {\n    if (this.observer) {\n      this.observer.disconnect();\n      this.observer = null;\n    }\n  }\n\n  /**\n   * Block all existing scripts with data-cookieconsent attribute\n   */\n  private blockExistingScripts(): void {\n    const scripts = document.querySelectorAll('script[data-cookieconsent]');\n    scripts.forEach((script) => {\n      if (script instanceof HTMLScriptElement) {\n        this.processScript(script);\n      }\n    });\n  }\n\n  /**\n   * Observe DOM for dynamically added scripts\n   */\n  private observeDOM(): void {\n    this.observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        mutation.addedNodes.forEach((node) => {\n          if (\n            node instanceof HTMLScriptElement &&\n            node.hasAttribute('data-cookieconsent')\n          ) {\n            this.processScript(node);\n          }\n        });\n      });\n    });\n\n    this.observer.observe(document.documentElement, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Process a script element - block or allow based on consent\n   */\n  private processScript(script: HTMLScriptElement): void {\n    const category = this.categoryManager.getCategoryForScript(script);\n\n    if (!category) return;\n\n    // Check if consent allows this category\n    if (\n      this.currentConsent &&\n      this.categoryManager.isAllowed(category, this.currentConsent)\n    ) {\n      // Already have consent, don't block\n      return;\n    }\n\n    // Block the script by changing its type\n    if (script.type !== 'text/plain') {\n      const id = this.generateScriptId(script);\n\n      // Store original type if it exists\n      const originalType = script.type || 'text/javascript';\n      script.setAttribute('data-original-type', originalType);\n\n      script.type = 'text/plain';\n      this.blockedScripts.set(id, script);\n    }\n  }\n\n  /**\n   * Reactivate a blocked script by creating a new one with correct type\n   */\n  private reactivateScript(script: HTMLScriptElement): void {\n    // Clone script and change type to execute it\n    const newScript = document.createElement('script');\n\n    // Copy attributes\n    Array.from(script.attributes).forEach((attr) => {\n      if (attr.name !== 'type' && attr.name !== 'data-original-type') {\n        newScript.setAttribute(attr.name, attr.value);\n      }\n    });\n\n    // Set correct type\n    const originalType = script.getAttribute('data-original-type') || 'text/javascript';\n    newScript.type = originalType;\n\n    // Copy content\n    if (script.src) {\n      newScript.src = script.src;\n    } else {\n      newScript.textContent = script.textContent;\n    }\n\n    // Replace old script\n    if (script.parentNode) {\n      script.parentNode.insertBefore(newScript, script);\n      script.parentNode.removeChild(script);\n    }\n\n    this.eventEmitter.emit('script:activated', {\n      category: script.getAttribute('data-cookieconsent'),\n      src: script.src || 'inline',\n    });\n  }\n\n  /**\n   * Generate unique ID for a script\n   */\n  private generateScriptId(script: HTMLScriptElement): string {\n    return script.src || `inline-${Date.now()}-${Math.random()}`;\n  }\n}\n","/**\n * CategoryManager - Maps scripts to consent categories and manages patterns\n */\n\nimport { ConsentCategories } from '../types';\n\nexport class CategoryManager {\n  private categories: Map<string, string[]> = new Map();\n\n  constructor() {\n    // Initialize with common patterns\n    this.initializeDefaultPatterns();\n  }\n\n  /**\n   * Register a category with URL patterns\n   */\n  public registerCategory(name: string, patterns: string[]): void {\n    this.categories.set(name, patterns);\n  }\n\n  /**\n   * Get category for a script element\n   */\n  public getCategoryForScript(script: HTMLScriptElement): string | null {\n    // Explicit category attribute takes precedence\n    const explicitCategory = script.getAttribute('data-cookieconsent');\n    if (explicitCategory) {\n      return explicitCategory;\n    }\n\n    // Try to match by src pattern\n    const src = script.src;\n    if (!src) return null;\n\n    for (const [category, patterns] of this.categories) {\n      if (patterns.some((pattern) => src.includes(pattern))) {\n        return category;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Check if a category is allowed based on consent\n   */\n  public isAllowed(category: string, consent: ConsentCategories): boolean {\n    return consent[category as keyof ConsentCategories] === true;\n  }\n\n  /**\n   * Initialize default URL patterns for common tracking services\n   */\n  private initializeDefaultPatterns(): void {\n    this.categories.set('analytics', [\n      'google-analytics.com',\n      'googletagmanager.com',\n      'analytics.google.com',\n      'plausible.io',\n      'matomo.org',\n      'hotjar.com',\n      'mixpanel.com',\n      'segment.com',\n      'amplitude.com',\n    ]);\n\n    this.categories.set('marketing', [\n      'facebook.net',\n      'facebook.com/tr',\n      'connect.facebook.net',\n      'doubleclick.net',\n      'ads.google.com',\n      'linkedin.com/analytics',\n      'twitter.com/i/adsct',\n      'pinterest.com/ct',\n      'adroll.com',\n      'taboola.com',\n      'outbrain.com',\n    ]);\n\n    this.categories.set('necessary', []);\n  }\n}\n","/**\n * Banner - Cookie consent banner component\n */\n\nimport { ConsentConfig, ConsentCategories } from '../types';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class Banner {\n  private config: ConsentConfig;\n  private element: HTMLElement | null = null;\n  private eventEmitter: EventEmitter;\n\n  constructor(config: ConsentConfig, eventEmitter: EventEmitter) {\n    this.config = config;\n    this.eventEmitter = eventEmitter;\n  }\n\n  /**\n   * Show the banner\n   */\n  public show(): void {\n    if (!this.element) {\n      this.element = this.createDOM();\n      document.body.appendChild(this.element);\n      this.attachListeners();\n    }\n\n    // Trigger animation\n    requestAnimationFrame(() => {\n      this.element?.classList.add('is-visible');\n    });\n\n    // Focus first button for accessibility\n    const firstButton = this.element?.querySelector('button');\n    firstButton?.focus();\n\n    // Disable page interaction if configured\n    if (this.config.disablePageInteraction) {\n      document.body.style.overflow = 'hidden';\n    }\n  }\n\n  /**\n   * Hide the banner\n   */\n  public hide(): void {\n    this.element?.classList.remove('is-visible');\n\n    // Re-enable page interaction\n    if (this.config.disablePageInteraction) {\n      document.body.style.overflow = '';\n    }\n\n    setTimeout(() => {\n      this.destroy();\n    }, 300); // Match CSS transition\n  }\n\n  /**\n   * Destroy the banner\n   */\n  public destroy(): void {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n  }\n\n  /**\n   * Create DOM structure for banner\n   */\n  private createDOM(): HTMLElement {\n    const translations = this.config.translations || {};\n    const theme = this.config.theme || 'light';\n    const position = this.config.position || 'bottom';\n    const layout = this.config.layout || 'bar';\n    const backdropBlur = this.config.backdropBlur !== false;\n\n    const template = `\n      <div\n        class=\"cc-banner cc-banner--${position} cc-banner--${layout} ${backdropBlur ? 'cc-backdrop-blur' : ''}\"\n        role=\"region\"\n        aria-label=\"Cookie consent\"\n        aria-live=\"polite\"\n        data-theme=\"${theme}\"\n        style=\"${this.config.primaryColor ? `--cc-primary: ${this.config.primaryColor};` : ''}\"\n      >\n        <div class=\"cc-banner__container\">\n          <div class=\"cc-banner__content\">\n            <h2 class=\"cc-banner__title\">\n              ${translations.title || 'üç™ Nous utilisons des cookies'}\n            </h2>\n            <p class=\"cc-banner__description\">\n              ${this.getDescriptionHTML()}\n            </p>\n          </div>\n          <div class=\"cc-banner__actions\">\n            <button\n              class=\"cc-btn cc-btn--secondary\"\n              data-action=\"reject\"\n              aria-label=\"Rejeter tous les cookies\"\n            >\n              ${translations.rejectAll || 'Tout rejeter'}\n            </button>\n            <button\n              class=\"cc-btn cc-btn--tertiary\"\n              data-action=\"customize\"\n              aria-label=\"Personnaliser les pr√©f√©rences\"\n            >\n              ${translations.customize || 'Personnaliser'}\n            </button>\n            <button\n              class=\"cc-btn cc-btn--primary\"\n              data-action=\"accept\"\n              aria-label=\"Accepter tous les cookies\"\n            >\n              ${translations.acceptAll || 'Tout accepter'}\n            </button>\n          </div>\n        </div>\n      </div>\n    `;\n\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = template.trim();\n    return wrapper.firstChild as HTMLElement;\n  }\n\n  /**\n   * Attach event listeners\n   */\n  private attachListeners(): void {\n    this.element?.addEventListener('click', (e) => {\n      const target = e.target as HTMLElement;\n      const action = target.getAttribute('data-action');\n\n      switch (action) {\n        case 'accept':\n          this.handleAcceptAll();\n          break;\n        case 'reject':\n          this.handleRejectAll();\n          break;\n        case 'customize':\n          this.handleCustomize();\n          break;\n      }\n    });\n\n    // Keyboard support\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape' && this.config.disablePageInteraction) {\n        // Allow ESC to close if page interaction is disabled\n        this.handleRejectAll();\n      }\n    });\n  }\n\n  /**\n   * Handle accept all action\n   */\n  private handleAcceptAll(): void {\n    const allCategories: ConsentCategories = {\n      necessary: true,\n      analytics: true,\n      marketing: true,\n    };\n\n    // Only add preferences if it's configured\n    if (this.config.categories.preferences) {\n      allCategories.preferences = true;\n    }\n\n    this.eventEmitter.emit('consent:accept', allCategories);\n    this.config.onAccept?.(allCategories);\n    this.hide();\n  }\n\n  /**\n   * Handle reject all action\n   */\n  private handleRejectAll(): void {\n    const necessaryOnly: ConsentCategories = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    };\n\n    // Only add preferences if it's configured\n    if (this.config.categories.preferences) {\n      necessaryOnly.preferences = false;\n    }\n\n    this.eventEmitter.emit('consent:reject', necessaryOnly);\n    this.config.onReject?.();\n    this.hide();\n  }\n\n  /**\n   * Handle customize action\n   */\n  private handleCustomize(): void {\n    this.eventEmitter.emit('preferences:show');\n    this.hide();\n  }\n\n  /**\n   * Generate description HTML with privacy policy link\n   */\n  private getDescriptionHTML(): string {\n    const translations = this.config.translations || {};\n    const defaultDescription = 'Pour am√©liorer votre exp√©rience sur notre site, nous utilisons des cookies. Vous pouvez choisir les cookies que vous acceptez.';\n    const description = translations.description || defaultDescription;\n\n    if (translations.privacyPolicyUrl) {\n      const linkLabel = translations.privacyPolicyLabel || 'Politique de confidentialit√©';\n      return `${description} <a href=\"${translations.privacyPolicyUrl}\" target=\"_blank\" rel=\"noopener noreferrer\">${linkLabel}</a>`;\n    }\n\n    return description;\n  }\n}\n","/**\n * PreferenceCenter - Modal for granular cookie preferences\n */\n\nimport { ConsentConfig, ConsentCategories } from '../types';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class PreferenceCenter {\n  private config: ConsentConfig;\n  private element: HTMLElement | null = null;\n  private eventEmitter: EventEmitter;\n  private currentConsent: ConsentCategories;\n\n  constructor(\n    config: ConsentConfig,\n    eventEmitter: EventEmitter,\n    currentConsent: ConsentCategories\n  ) {\n    this.config = config;\n    this.eventEmitter = eventEmitter;\n    this.currentConsent = currentConsent;\n  }\n\n  /**\n   * Show the preference center\n   */\n  public show(): void {\n    if (!this.element) {\n      this.element = this.createDOM();\n      document.body.appendChild(this.element);\n      this.attachListeners();\n    }\n\n    this.element.classList.add('is-visible');\n    this.trapFocus();\n\n    // Prevent body scroll\n    document.body.style.overflow = 'hidden';\n  }\n\n  /**\n   * Hide the preference center\n   */\n  public hide(): void {\n    this.element?.classList.remove('is-visible');\n    document.body.style.overflow = '';\n\n    setTimeout(() => {\n      this.destroy();\n    }, 300);\n  }\n\n  /**\n   * Destroy the preference center\n   */\n  public destroy(): void {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n  }\n\n  /**\n   * Create DOM structure for preference center\n   */\n  private createDOM(): HTMLElement {\n    const translations = this.config.translations || {};\n    const theme = this.config.theme || 'light';\n    const position = this.config.preferencesPosition || 'center';\n\n    const template = `\n      <div\n        class=\"cc-modal cc-modal--${position}\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"cc-modal-title\"\n        data-theme=\"${theme}\"\n      >\n        <div class=\"cc-modal__overlay\" data-action=\"close\"></div>\n        <div class=\"cc-modal__content\">\n          <div class=\"cc-modal__header\" style=\"${this.config.primaryColor ? `--cc-primary: ${this.config.primaryColor}; --cc-primary-hover: ${this.adjustColorBrightness(this.config.primaryColor, -15)};` : ''}\">\n            <h2 id=\"cc-modal-title\">\n              ${translations.preferencesTitle || translations.title || 'Pr√©f√©rences de cookies'}\n            </h2>\n            <button\n              class=\"cc-modal__close\"\n              aria-label=\"Fermer\"\n              data-action=\"close\"\n            >\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                <path d=\"M18 6L6 18M6 6l12 12\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n              </svg>\n            </button>\n          </div>\n\n          <div class=\"cc-modal__body\">\n            ${this.renderCategories()}\n          </div>\n\n          <div class=\"cc-modal__footer\">\n            <div class=\"cc-modal__footer-links\">\n              ${translations.privacyPolicyUrl ? `\n                <a href=\"${translations.privacyPolicyUrl}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"cc-privacy-link\">\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\n                    <polyline points=\"15 3 21 3 21 9\"/>\n                    <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"/>\n                  </svg>\n                  ${translations.privacyPolicyLabel || 'Politique de confidentialit√©'}\n                </a>\n              ` : ''}\n            </div>\n            <div class=\"cc-modal__footer-actions\">\n              <button\n                class=\"cc-btn cc-btn--secondary\"\n                data-action=\"reject\"\n              >\n                ${translations.rejectAll || 'Tout rejeter'}\n              </button>\n              <button\n                class=\"cc-btn cc-btn--primary\"\n                data-action=\"save\"\n              >\n                ${translations.savePreferences || 'Sauvegarder'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = template.trim();\n    return wrapper.firstChild as HTMLElement;\n  }\n\n  /**\n   * Render category toggles\n   */\n  private renderCategories(): string {\n    const categories = Object.entries(this.config.categories);\n\n    return categories\n      .map(([key, config]) => {\n        const checked = this.currentConsent[key as keyof ConsentCategories];\n        const disabled = config.readOnly;\n\n        return `\n        <div class=\"cc-category\">\n          <div class=\"cc-category__header\">\n            <label class=\"cc-toggle ${disabled ? 'cc-toggle--disabled' : ''}\">\n              <input\n                type=\"checkbox\"\n                data-category=\"${key}\"\n                ${checked ? 'checked' : ''}\n                ${disabled ? 'disabled' : ''}\n                aria-label=\"${config.label} cookies\"\n              >\n              <span class=\"cc-toggle__slider\"></span>\n            </label>\n            <div class=\"cc-category__info\">\n              <h3>${config.label}</h3>\n              <p>${config.description}</p>\n            </div>\n          </div>\n        </div>\n      `;\n      })\n      .join('');\n  }\n\n  /**\n   * Attach event listeners\n   */\n  private attachListeners(): void {\n    this.element?.addEventListener('click', (e) => {\n      const target = e.target as HTMLElement;\n      const action = target.getAttribute('data-action');\n\n      if (action === 'close') {\n        this.hide();\n      } else if (action === 'save') {\n        this.handleSave();\n      } else if (action === 'reject') {\n        this.handleRejectAll();\n      }\n    });\n\n    // Keyboard shortcuts\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape') {\n        this.hide();\n      }\n    });\n  }\n\n  /**\n   * Handle save preferences\n   */\n  private handleSave(): void {\n    const checkboxes = this.element?.querySelectorAll('input[data-category]');\n    const categories: ConsentCategories = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    };\n\n    checkboxes?.forEach((checkbox) => {\n      if (checkbox instanceof HTMLInputElement) {\n        const category = checkbox.getAttribute('data-category');\n        if (category) {\n          categories[category as keyof ConsentCategories] = checkbox.checked;\n        }\n      }\n    });\n\n    this.eventEmitter.emit('consent:update', categories);\n    this.config.onChange?.(categories);\n    this.hide();\n  }\n\n  /**\n   * Handle reject all\n   */\n  private handleRejectAll(): void {\n    const necessaryOnly: ConsentCategories = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    };\n\n    // Only add preferences if it's configured\n    if (this.config.categories.preferences) {\n      necessaryOnly.preferences = false;\n    }\n\n    this.eventEmitter.emit('consent:reject', necessaryOnly);\n    this.hide();\n  }\n\n  /**\n   * Trap focus within modal\n   */\n  private trapFocus(): void {\n    const focusableElements = this.element?.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n\n    if (!focusableElements || focusableElements.length === 0) return;\n\n    const firstFocusable = focusableElements[0] as HTMLElement;\n    const lastFocusable = focusableElements[focusableElements.length - 1] as HTMLElement;\n\n    // Focus first element\n    firstFocusable?.focus();\n\n    // Trap focus\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Tab') {\n        if (e.shiftKey && document.activeElement === firstFocusable) {\n          e.preventDefault();\n          lastFocusable.focus();\n        } else if (!e.shiftKey && document.activeElement === lastFocusable) {\n          e.preventDefault();\n          firstFocusable.focus();\n        }\n      }\n    });\n  }\n\n  /**\n   * Adjust color brightness for hover effect\n   */\n  private adjustColorBrightness(color: string, percent: number): string {\n    // Remove # if present\n    const hex = color.replace('#', '');\n\n    // Convert to RGB\n    const r = parseInt(hex.substring(0, 2), 16);\n    const g = parseInt(hex.substring(2, 4), 16);\n    const b = parseInt(hex.substring(4, 6), 16);\n\n    // Adjust brightness\n    const adjust = (value: number) => {\n      const adjusted = value + (value * percent / 100);\n      return Math.max(0, Math.min(255, Math.round(adjusted)));\n    };\n\n    // Convert back to hex\n    const toHex = (value: number) => {\n      const hex = value.toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    };\n\n    return `#${toHex(adjust(r))}${toHex(adjust(g))}${toHex(adjust(b))}`;\n  }\n}\n","/**\n * FloatingWidget - Permanent cookie settings button\n * Stays visible at all times for easy access to preferences\n */\n\nimport { ConsentConfig } from '../types';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class FloatingWidget {\n  private config: ConsentConfig;\n  private element: HTMLElement | null = null;\n  private eventEmitter: EventEmitter;\n  private isVisible: boolean = false;\n\n  constructor(config: ConsentConfig, eventEmitter: EventEmitter) {\n    this.config = config;\n    this.eventEmitter = eventEmitter;\n  }\n\n  /**\n   * Show the floating widget\n   */\n  public show(): void {\n    console.log('üéØ FloatingWidget.show() called');\n\n    if (!this.element) {\n      this.element = this.createDOM();\n      document.body.appendChild(this.element);\n      this.attachListeners();\n      console.log('‚úÖ Widget element created and appended to body');\n    }\n\n    // Delay to allow for transition\n    requestAnimationFrame(() => {\n      this.element?.classList.add('is-visible');\n      this.isVisible = true;\n      console.log('‚úÖ Widget is-visible class added');\n    });\n  }\n\n  /**\n   * Hide the floating widget\n   */\n  public hide(): void {\n    this.element?.classList.remove('is-visible');\n    this.isVisible = false;\n  }\n\n  /**\n   * Destroy the widget\n   */\n  public destroy(): void {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n    this.isVisible = false;\n  }\n\n  /**\n   * Check if widget is visible\n   */\n  public getIsVisible(): boolean {\n    return this.isVisible;\n  }\n\n  /**\n   * Create DOM structure for floating widget\n   */\n  private createDOM(): HTMLElement {\n    const translations = this.config.translations || {};\n    const theme = this.config.theme || 'light';\n    const widgetPosition = this.config.widgetPosition || 'bottom-right';\n    const widgetStyle = this.config.widgetStyle || 'full';\n\n    console.log('üç™ Widget config:', { widgetPosition, widgetStyle, configWidgetStyle: this.config.widgetStyle });\n\n    const template = `\n      <div\n        class=\"cc-widget cc-widget--${widgetPosition} cc-widget--${widgetStyle}\"\n        role=\"button\"\n        aria-label=\"${translations.cookieSettings || 'Param√®tres des cookies'}\"\n        tabindex=\"0\"\n        data-theme=\"${theme}\"\n        style=\"${this.config.primaryColor ? `--cc-primary: ${this.config.primaryColor};` : ''}\"\n      >\n        <svg class=\"cc-widget__icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n          <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"/>\n          <circle cx=\"12\" cy=\"12\" r=\"2\"/>\n          <circle cx=\"7\" cy=\"7\" r=\"1.5\"/>\n          <circle cx=\"17\" cy=\"7\" r=\"1.5\"/>\n          <circle cx=\"7\" cy=\"17\" r=\"1.5\"/>\n          <circle cx=\"17\" cy=\"17\" r=\"1.5\"/>\n        </svg>\n        <span class=\"cc-widget__text\">\n          ${translations.cookies || 'Cookies'}\n        </span>\n      </div>\n    `;\n\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = template.trim();\n    return wrapper.firstChild as HTMLElement;\n  }\n\n  /**\n   * Attach event listeners\n   */\n  private attachListeners(): void {\n    this.element?.addEventListener('click', () => {\n      this.handleClick();\n    });\n\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        this.handleClick();\n      }\n    });\n  }\n\n  /**\n   * Handle widget click\n   */\n  private handleClick(): void {\n    this.eventEmitter.emit('preferences:show');\n  }\n}\n","/**\n * GTMConsentMode - Integration with Google Consent Mode v2\n */\n\nimport { ConsentCategories, GTMConsent } from '../types';\nimport { DataLayerManager } from './DataLayerManager';\n\nexport class GTMConsentMode {\n  private dataLayerManager: DataLayerManager;\n\n  constructor(dataLayerManager: DataLayerManager) {\n    this.dataLayerManager = dataLayerManager;\n  }\n\n  /**\n   * Set default consent state (MUST be called BEFORE GTM loads)\n   */\n  public setDefaultConsent(): void {\n    this.dataLayerManager.push('consent', 'default', {\n      ad_storage: 'denied',\n      ad_user_data: 'denied',\n      ad_personalization: 'denied',\n      analytics_storage: 'denied',\n      functionality_storage: 'denied',\n      personalization_storage: 'denied',\n      security_storage: 'granted', // Always granted\n    });\n  }\n\n  /**\n   * Update consent state based on user choices\n   */\n  public updateConsent(categories: ConsentCategories): void {\n    const gtmConsent = this.mapCategoriesToGTM(categories);\n    this.dataLayerManager.push('consent', 'update', gtmConsent);\n  }\n\n  /**\n   * Map consent categories to GTM Consent Mode v2 format\n   */\n  private mapCategoriesToGTM(categories: ConsentCategories): GTMConsent {\n    return {\n      ad_storage: categories.marketing ? 'granted' : 'denied',\n      ad_user_data: categories.marketing ? 'granted' : 'denied',\n      ad_personalization: categories.marketing ? 'granted' : 'denied',\n      analytics_storage: categories.analytics ? 'granted' : 'denied',\n      functionality_storage: categories.preferences ? 'granted' : 'denied',\n      personalization_storage: categories.preferences ? 'granted' : 'denied',\n      security_storage: 'granted', // Always granted\n    };\n  }\n}\n","/**\n * DataLayerManager - Manages Google Tag Manager dataLayer communication\n */\n\nexport class DataLayerManager {\n  /**\n   * Push data to GTM dataLayer\n   */\n  public push(command: string, action: string, params: any): void {\n    // Initialize dataLayer if it doesn't exist\n    window.dataLayer = window.dataLayer || [];\n\n    // Push to dataLayer\n    window.dataLayer.push({\n      event: 'consent_update',\n      [command]: {\n        [action]: params,\n      },\n    });\n\n    // Also push using gtag format if available\n    if (typeof window.gtag === 'function') {\n      window.gtag(command, action, params);\n    }\n  }\n}\n","/**\n * CookieConsent - Main orchestrator class\n */\n\nimport { ConsentConfig, ConsentCategories } from '../types';\nimport { ConsentManager } from './ConsentManager';\nimport { StorageManager } from './StorageManager';\nimport { EventEmitter } from './EventEmitter';\nimport { ScriptBlocker } from '../blocking/ScriptBlocker';\nimport { CategoryManager } from '../blocking/CategoryManager';\nimport { Banner } from '../ui/Banner';\nimport { PreferenceCenter } from '../ui/PreferenceCenter';\nimport { FloatingWidget } from '../ui/FloatingWidget';\nimport { GTMConsentMode } from '../integrations/GTMConsentMode';\nimport { DataLayerManager } from '../integrations/DataLayerManager';\n\n// Import CSS\nimport '../styles/banner.css';\nimport '../styles/animations.css';\nimport '../styles/preferences.css';\nimport '../styles/widget.css';\n\nexport class CookieConsent {\n  private config: ConsentConfig;\n  private consentManager: ConsentManager;\n  private storageManager: StorageManager;\n  private scriptBlocker: ScriptBlocker;\n  private eventEmitter: EventEmitter;\n  private banner: Banner | null = null;\n  private preferenceCenter: PreferenceCenter | null = null;\n  private floatingWidget: FloatingWidget | null = null;\n  private gtmIntegration: GTMConsentMode | null = null;\n\n  constructor(config: ConsentConfig) {\n    this.config = this.validateConfig(config);\n    this.consentManager = new ConsentManager(this.config);\n    this.storageManager = new StorageManager();\n    this.eventEmitter = new EventEmitter();\n    this.scriptBlocker = new ScriptBlocker(\n      new CategoryManager(),\n      this.eventEmitter\n    );\n\n    if (this.config.gtmConsentMode) {\n      this.gtmIntegration = new GTMConsentMode(new DataLayerManager());\n    }\n\n    // Listen for preference center requests\n    this.eventEmitter.on('preferences:show', () => {\n      this.showPreferences();\n    });\n\n    // Listen for consent updates\n    this.eventEmitter.on('consent:accept', (categories: ConsentCategories) => {\n      this.updateConsent(categories);\n    });\n\n    this.eventEmitter.on('consent:reject', (categories: ConsentCategories) => {\n      this.updateConsent(categories);\n    });\n\n    this.eventEmitter.on('consent:update', (categories: ConsentCategories) => {\n      this.updateConsent(categories);\n    });\n  }\n\n  /**\n   * Initialize the cookie consent system\n   */\n  public init(): void {\n    // 1. Start blocking scripts immediately\n    this.scriptBlocker.init();\n\n    // 2. Set GTM default consent BEFORE checking storage\n    if (this.gtmIntegration) {\n      this.gtmIntegration.setDefaultConsent();\n    }\n\n    // 3. Check for existing consent\n    const storedConsent = this.storageManager.load();\n\n    if (storedConsent && !this.storageManager.isExpired(storedConsent)) {\n      // Valid consent exists\n      if (this.consentManager.needsUpdate(storedConsent)) {\n        // Policy updated, show banner again\n        if (this.config.autoShow) {\n          this.showBanner();\n        }\n      } else {\n        // Apply stored consent\n        this.applyConsent(storedConsent.categories);\n        this.eventEmitter.emit('consent:load', storedConsent);\n\n        // Show floating widget if enabled\n        if (this.config.showWidget) {\n          this.showFloatingWidget();\n        }\n      }\n    } else {\n      // No consent or expired\n      if (this.config.autoShow) {\n        this.showBanner();\n      }\n    }\n\n    this.eventEmitter.emit('consent:init');\n  }\n\n  /**\n   * Show the banner\n   */\n  public show(): void {\n    this.showBanner();\n  }\n\n  /**\n   * Hide the banner\n   */\n  public hide(): void {\n    this.banner?.hide();\n  }\n\n  /**\n   * Show preferences modal\n   */\n  public showPreferences(): void {\n    const currentConsent =\n      this.storageManager.load()?.categories || {\n        necessary: true,\n        analytics: false,\n        marketing: false,\n        preferences: false,\n      };\n\n    // Always recreate to get fresh state from storage\n    if (this.preferenceCenter) {\n      this.preferenceCenter.destroy();\n    }\n\n    this.preferenceCenter = new PreferenceCenter(\n      this.config,\n      this.eventEmitter,\n      currentConsent\n    );\n    this.preferenceCenter.show();\n  }\n\n  /**\n   * Update consent with new categories\n   */\n  public updateConsent(categories: ConsentCategories): void {\n    const consentRecord = this.consentManager.updateConsent(categories);\n    this.storageManager.save(consentRecord);\n    this.applyConsent(categories);\n\n    if (this.gtmIntegration) {\n      this.gtmIntegration.updateConsent(categories);\n    }\n\n    // Show floating widget after consent is given (delay to let banner hide)\n    if (this.config.showWidget) {\n      console.log('‚è≥ Widget will show in 400ms...');\n      setTimeout(() => {\n        console.log('üöÄ Calling showFloatingWidget()');\n        this.showFloatingWidget();\n      }, 400); // Wait for banner hide animation\n    } else {\n      console.log('‚ùå Widget disabled in config');\n    }\n  }\n\n  /**\n   * Get current consent\n   */\n  public getConsent() {\n    return this.storageManager.load();\n  }\n\n  /**\n   * Reset consent (clear stored data and show banner)\n   */\n  public reset(): void {\n    this.storageManager.clear();\n    this.scriptBlocker.block();\n    this.showBanner();\n  }\n\n  /**\n   * Register event handler\n   */\n  public on(event: string, callback: Function): void {\n    this.eventEmitter.on(event, callback);\n  }\n\n  /**\n   * Unregister event handler\n   */\n  public off(event: string, callback: Function): void {\n    this.eventEmitter.off(event, callback);\n  }\n\n  /**\n   * Destroy and cleanup all UI elements\n   */\n  public destroy(): void {\n    this.banner?.destroy();\n    this.banner = null;\n    this.preferenceCenter?.destroy();\n    this.preferenceCenter = null;\n    this.floatingWidget?.destroy();\n    this.floatingWidget = null;\n    this.scriptBlocker?.destroy();\n  }\n\n  /**\n   * Show the banner\n   */\n  private showBanner(): void {\n    if (!this.banner) {\n      this.banner = new Banner(this.config, this.eventEmitter);\n    }\n    this.banner.show();\n    this.eventEmitter.emit('consent:show');\n  }\n\n  /**\n   * Show the floating widget\n   */\n  private showFloatingWidget(): void {\n    if (!this.floatingWidget) {\n      this.floatingWidget = new FloatingWidget(this.config, this.eventEmitter);\n    }\n    this.floatingWidget.show();\n  }\n\n  /**\n   * Apply consent by unblocking scripts\n   */\n  private applyConsent(categories: ConsentCategories): void {\n    this.scriptBlocker.unblock(categories);\n  }\n\n  /**\n   * Validate and set default config values\n   */\n  private validateConfig(config: ConsentConfig): ConsentConfig {\n    return {\n      ...config,\n      mode: config.mode || 'opt-in',\n      autoShow: config.autoShow !== undefined ? config.autoShow : true,\n      revision: config.revision || 1,\n      gtmConsentMode: config.gtmConsentMode || false,\n      disablePageInteraction: config.disablePageInteraction || false,\n      theme: config.theme || 'light',\n      position: config.position || 'bottom',\n      layout: config.layout || 'bar',\n      backdropBlur: config.backdropBlur !== false,\n      animationStyle: config.animationStyle || 'smooth',\n      preferencesPosition: config.preferencesPosition || 'center',\n      showWidget: config.showWidget !== undefined ? config.showWidget : true,\n      widgetPosition: config.widgetPosition || 'bottom-right',\n      widgetStyle: config.widgetStyle || 'full',\n    };\n  }\n}\n"],"names":["ConsentManager","constructor","config","this","validateConsent","categories","necessary","key","Object","keys","updateConsent","Error","consent","createConsentRecord","needsConsent","undefined","needsUpdate","storedConsent","version","revision","getCurrentConsent","now","Date","expiryDate","setMonth","getMonth","timestamp","toISOString","assign","userAgent","navigator","expiresAt","StorageManager","save","localStorage","setItem","STORAGE_KEY","JSON","stringify","e","console","error","load","data","getItem","parsed","parse","validateSchema","migrated","migrate","clear","removeItem","isExpired","oldData","EXPIRY_MONTHS","EventEmitter","events","Map","on","event","callback","has","set","Set","get","add","off","delete","emit","forEach","clearEvent","ScriptBlocker","categoryManager","eventEmitter","observer","blockedScripts","currentConsent","init","blockExistingScripts","observeDOM","block","unblock","script","id","category","getCategoryForScript","isAllowed","reactivateScript","destroy","disconnect","document","querySelectorAll","HTMLScriptElement","processScript","MutationObserver","mutations","mutation","addedNodes","node","hasAttribute","observe","documentElement","childList","subtree","type","generateScriptId","setAttribute","newScript","createElement","Array","from","attributes","attr","name","value","originalType","getAttribute","src","textContent","parentNode","insertBefore","removeChild","Math","random","CategoryManager","initializeDefaultPatterns","registerCategory","patterns","explicitCategory","some","pattern","includes","Banner","element","show","createDOM","body","appendChild","attachListeners","requestAnimationFrame","_a","classList","firstButton","querySelector","focus","disablePageInteraction","style","overflow","hide","remove","setTimeout","translations","template","position","layout","backdropBlur","theme","primaryColor","title","getDescriptionHTML","rejectAll","customize","acceptAll","wrapper","innerHTML","trim","firstChild","addEventListener","target","handleAcceptAll","handleRejectAll","handleCustomize","_b","allCategories","analytics","marketing","preferences","onAccept","call","necessaryOnly","onReject","description","privacyPolicyUrl","privacyPolicyLabel","PreferenceCenter","trapFocus","preferencesPosition","adjustColorBrightness","preferencesTitle","renderCategories","savePreferences","entries","map","disabled","readOnly","label","join","action","handleSave","checkboxes","checkbox","HTMLInputElement","checked","_c","onChange","focusableElements","length","firstFocusable","lastFocusable","shiftKey","activeElement","preventDefault","color","percent","hex","replace","r","parseInt","substring","g","b","adjust","max","min","round","toHex","toString","FloatingWidget","isVisible","log","getIsVisible","widgetPosition","widgetStyle","configWidgetStyle","cookieSettings","cookies","handleClick","GTMConsentMode","dataLayerManager","setDefaultConsent","push","ad_storage","ad_user_data","ad_personalization","analytics_storage","functionality_storage","personalization_storage","security_storage","gtmConsent","mapCategoriesToGTM","DataLayerManager","command","params","window","dataLayer","gtag","CookieConsent","banner","preferenceCenter","floatingWidget","gtmIntegration","validateConfig","consentManager","storageManager","scriptBlocker","gtmConsentMode","showPreferences","autoShow","showBanner","applyConsent","showWidget","showFloatingWidget","consentRecord","getConsent","reset","_d","mode","animationStyle"],"mappings":"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"}