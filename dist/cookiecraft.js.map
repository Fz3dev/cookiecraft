{"version":3,"file":"cookiecraft.js","sources":["../src/core/ConsentManager.ts","../src/core/StorageManager.ts","../src/core/EventEmitter.ts","../src/blocking/ScriptBlocker.ts","../src/blocking/CategoryManager.ts","../src/ui/Banner.ts","../src/ui/PreferenceCenter.ts","../src/ui/FloatingWidget.ts","../src/integrations/GTMConsentMode.ts","../src/integrations/DataLayerManager.ts","../src/core/CookieConsent.ts"],"sourcesContent":["/**\n * ConsentManager - Handles consent logic and validation\n */\n\nimport { ConsentConfig, ConsentCategories, ConsentRecord } from '../types';\n\nexport class ConsentManager {\n  private consent!: ConsentRecord;\n  private config: ConsentConfig;\n\n  constructor(config: ConsentConfig) {\n    this.config = config;\n  }\n\n  /**\n   * Validate consent categories\n   */\n  public validateConsent(categories: ConsentCategories): boolean {\n    // Necessary cookies must always be enabled\n    if (!categories.necessary) {\n      return false;\n    }\n\n    // Validate against config\n    for (const key of Object.keys(categories)) {\n      if (!(key in this.config.categories)) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  /**\n   * Update consent with new categories\n   */\n  public updateConsent(categories: ConsentCategories): ConsentRecord {\n    if (!this.validateConsent(categories)) {\n      throw new Error('Invalid consent categories');\n    }\n\n    this.consent = this.createConsentRecord(categories);\n    return this.consent;\n  }\n\n  /**\n   * Check if user needs to give consent\n   */\n  public needsConsent(): boolean {\n    return this.consent === undefined;\n  }\n\n  /**\n   * Check if stored consent needs update due to policy change\n   */\n  public needsUpdate(storedConsent: ConsentRecord): boolean {\n    // Check if policy version has changed\n    return storedConsent.version < this.config.revision;\n  }\n\n  /**\n   * Get current consent record\n   */\n  public getCurrentConsent(): ConsentRecord {\n    return this.consent;\n  }\n\n  /**\n   * Create a new consent record\n   */\n  private createConsentRecord(categories: ConsentCategories): ConsentRecord {\n    const now = new Date();\n    const expiryDate = new Date(now);\n    expiryDate.setMonth(expiryDate.getMonth() + 13); // 13 months per GDPR\n\n    return {\n      version: this.config.revision,\n      timestamp: now.toISOString(),\n      categories: { ...categories },\n      userAgent: navigator.userAgent,\n      expiresAt: expiryDate.toISOString(),\n    };\n  }\n}\n","/**\n * StorageManager - Manages localStorage persistence for consent records\n */\n\nimport { ConsentRecord } from '../types';\n\nexport class StorageManager {\n  private static readonly STORAGE_KEY = 'cookiecraft_consent';\n  private static readonly EXPIRY_MONTHS = 13;\n\n  /**\n   * Save consent record to localStorage\n   */\n  public save(consent: ConsentRecord): void {\n    try {\n      localStorage.setItem(\n        StorageManager.STORAGE_KEY,\n        JSON.stringify(consent)\n      );\n    } catch (e) {\n      console.error('Failed to save consent:', e);\n    }\n  }\n\n  /**\n   * Load consent record from localStorage\n   */\n  public load(): ConsentRecord | null {\n    try {\n      const data = localStorage.getItem(StorageManager.STORAGE_KEY);\n      if (!data) return null;\n\n      const parsed = JSON.parse(data);\n\n      // Validate schema\n      if (!this.validateSchema(parsed)) {\n        // Try migration\n        const migrated = this.migrate(parsed);\n        if (migrated) {\n          this.save(migrated);\n          return migrated;\n        }\n        return null;\n      }\n\n      return parsed;\n    } catch (e) {\n      console.error('Failed to load consent:', e);\n      return null;\n    }\n  }\n\n  /**\n   * Clear consent record from localStorage\n   */\n  public clear(): void {\n    localStorage.removeItem(StorageManager.STORAGE_KEY);\n  }\n\n  /**\n   * Check if consent record has expired\n   */\n  public isExpired(consent: ConsentRecord): boolean {\n    const expiry = new Date(consent.expiresAt);\n    return expiry < new Date();\n  }\n\n  /**\n   * Validate consent record schema\n   */\n  private validateSchema(data: any): boolean {\n    return (\n      data &&\n      typeof data.version === 'number' &&\n      typeof data.timestamp === 'string' &&\n      typeof data.categories === 'object' &&\n      typeof data.userAgent === 'string' &&\n      typeof data.expiresAt === 'string'\n    );\n  }\n\n  /**\n   * Migrate old consent format to new format\n   * Returns null if migration fails\n   */\n  private migrate(oldData: any): ConsentRecord | null {\n    // Handle migration from older versions\n    // For v1, no migration needed - just return null\n    return null;\n  }\n}\n","/**\n * EventEmitter - Simple pub/sub pattern for internal and external events\n */\n\nexport class EventEmitter {\n  private events: Map<string, Set<Function>> = new Map();\n\n  /**\n   * Register an event handler\n   */\n  public on(event: string, callback: Function): void {\n    if (!this.events.has(event)) {\n      this.events.set(event, new Set());\n    }\n    this.events.get(event)!.add(callback);\n  }\n\n  /**\n   * Unregister an event handler\n   */\n  public off(event: string, callback: Function): void {\n    if (this.events.has(event)) {\n      this.events.get(event)!.delete(callback);\n    }\n  }\n\n  /**\n   * Emit an event with optional data\n   */\n  public emit(event: string, data?: any): void {\n    if (this.events.has(event)) {\n      this.events.get(event)!.forEach((callback) => {\n        try {\n          callback(data);\n        } catch (e) {\n          console.error(`Error in event handler for ${event}:`, e);\n        }\n      });\n    }\n  }\n\n  /**\n   * Clear all event handlers\n   */\n  public clear(): void {\n    this.events.clear();\n  }\n\n  /**\n   * Clear handlers for a specific event\n   */\n  public clearEvent(event: string): void {\n    this.events.delete(event);\n  }\n}\n","/**\n * ScriptBlocker - Prevents scripts from executing before consent using MutationObserver\n */\n\nimport { ConsentCategories } from '../types';\nimport { CategoryManager } from './CategoryManager';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class ScriptBlocker {\n  private observer: MutationObserver | null = null;\n  private blockedScripts: Map<string, HTMLScriptElement> = new Map();\n  private categoryManager: CategoryManager;\n  private eventEmitter: EventEmitter;\n  private currentConsent: ConsentCategories | null = null;\n\n  constructor(categoryManager: CategoryManager, eventEmitter: EventEmitter) {\n    this.categoryManager = categoryManager;\n    this.eventEmitter = eventEmitter;\n  }\n\n  /**\n   * Initialize script blocking\n   */\n  public init(): void {\n    // Block all existing scripts\n    this.blockExistingScripts();\n\n    // Watch for dynamically added scripts (GTM, etc.)\n    this.observeDOM();\n  }\n\n  /**\n   * Block all scripts (reset consent)\n   */\n  public block(): void {\n    this.currentConsent = null;\n    this.blockExistingScripts();\n  }\n\n  /**\n   * Unblock scripts based on consent categories\n   */\n  public unblock(categories: ConsentCategories): void {\n    this.currentConsent = categories;\n\n    // Reactivate blocked scripts based on consent\n    this.blockedScripts.forEach((script, id) => {\n      const category = this.categoryManager.getCategoryForScript(script);\n      if (category && this.categoryManager.isAllowed(category, categories)) {\n        this.reactivateScript(script);\n        this.blockedScripts.delete(id);\n      }\n    });\n  }\n\n  /**\n   * Destroy the blocker and stop observing\n   */\n  public destroy(): void {\n    if (this.observer) {\n      this.observer.disconnect();\n      this.observer = null;\n    }\n  }\n\n  /**\n   * Block all existing scripts with data-cookieconsent attribute\n   */\n  private blockExistingScripts(): void {\n    const scripts = document.querySelectorAll('script[data-cookieconsent]');\n    scripts.forEach((script) => {\n      if (script instanceof HTMLScriptElement) {\n        this.processScript(script);\n      }\n    });\n  }\n\n  /**\n   * Observe DOM for dynamically added scripts\n   */\n  private observeDOM(): void {\n    this.observer = new MutationObserver((mutations) => {\n      mutations.forEach((mutation) => {\n        mutation.addedNodes.forEach((node) => {\n          if (\n            node instanceof HTMLScriptElement &&\n            node.hasAttribute('data-cookieconsent')\n          ) {\n            this.processScript(node);\n          }\n        });\n      });\n    });\n\n    this.observer.observe(document.documentElement, {\n      childList: true,\n      subtree: true,\n    });\n  }\n\n  /**\n   * Process a script element - block or allow based on consent\n   */\n  private processScript(script: HTMLScriptElement): void {\n    const category = this.categoryManager.getCategoryForScript(script);\n\n    if (!category) return;\n\n    // Check if consent allows this category\n    if (\n      this.currentConsent &&\n      this.categoryManager.isAllowed(category, this.currentConsent)\n    ) {\n      // Already have consent, don't block\n      return;\n    }\n\n    // Block the script by changing its type\n    if (script.type !== 'text/plain') {\n      const id = this.generateScriptId(script);\n\n      // Store original type if it exists\n      const originalType = script.type || 'text/javascript';\n      script.setAttribute('data-original-type', originalType);\n\n      script.type = 'text/plain';\n      this.blockedScripts.set(id, script);\n    }\n  }\n\n  /**\n   * Reactivate a blocked script by creating a new one with correct type\n   */\n  private reactivateScript(script: HTMLScriptElement): void {\n    // Clone script and change type to execute it\n    const newScript = document.createElement('script');\n\n    // Copy attributes\n    Array.from(script.attributes).forEach((attr) => {\n      if (attr.name !== 'type' && attr.name !== 'data-original-type') {\n        newScript.setAttribute(attr.name, attr.value);\n      }\n    });\n\n    // Set correct type\n    const originalType = script.getAttribute('data-original-type') || 'text/javascript';\n    newScript.type = originalType;\n\n    // Copy content\n    if (script.src) {\n      newScript.src = script.src;\n    } else {\n      newScript.textContent = script.textContent;\n    }\n\n    // Replace old script\n    if (script.parentNode) {\n      script.parentNode.insertBefore(newScript, script);\n      script.parentNode.removeChild(script);\n    }\n\n    this.eventEmitter.emit('script:activated', {\n      category: script.getAttribute('data-cookieconsent'),\n      src: script.src || 'inline',\n    });\n  }\n\n  /**\n   * Generate unique ID for a script\n   */\n  private generateScriptId(script: HTMLScriptElement): string {\n    return script.src || `inline-${Date.now()}-${Math.random()}`;\n  }\n}\n","/**\n * CategoryManager - Maps scripts to consent categories and manages patterns\n */\n\nimport { ConsentCategories } from '../types';\n\nexport class CategoryManager {\n  private categories: Map<string, string[]> = new Map();\n\n  constructor() {\n    // Initialize with common patterns\n    this.initializeDefaultPatterns();\n  }\n\n  /**\n   * Register a category with URL patterns\n   */\n  public registerCategory(name: string, patterns: string[]): void {\n    this.categories.set(name, patterns);\n  }\n\n  /**\n   * Get category for a script element\n   */\n  public getCategoryForScript(script: HTMLScriptElement): string | null {\n    // Explicit category attribute takes precedence\n    const explicitCategory = script.getAttribute('data-cookieconsent');\n    if (explicitCategory) {\n      return explicitCategory;\n    }\n\n    // Try to match by src pattern\n    const src = script.src;\n    if (!src) return null;\n\n    for (const [category, patterns] of this.categories) {\n      if (patterns.some((pattern) => src.includes(pattern))) {\n        return category;\n      }\n    }\n\n    return null;\n  }\n\n  /**\n   * Check if a category is allowed based on consent\n   */\n  public isAllowed(category: string, consent: ConsentCategories): boolean {\n    return consent[category as keyof ConsentCategories] === true;\n  }\n\n  /**\n   * Initialize default URL patterns for common tracking services\n   */\n  private initializeDefaultPatterns(): void {\n    this.categories.set('analytics', [\n      'google-analytics.com',\n      'googletagmanager.com',\n      'analytics.google.com',\n      'plausible.io',\n      'matomo.org',\n      'hotjar.com',\n      'mixpanel.com',\n      'segment.com',\n      'amplitude.com',\n    ]);\n\n    this.categories.set('marketing', [\n      'facebook.net',\n      'facebook.com/tr',\n      'connect.facebook.net',\n      'doubleclick.net',\n      'ads.google.com',\n      'linkedin.com/analytics',\n      'twitter.com/i/adsct',\n      'pinterest.com/ct',\n      'adroll.com',\n      'taboola.com',\n      'outbrain.com',\n    ]);\n\n    this.categories.set('necessary', []);\n  }\n}\n","/**\n * Banner - Cookie consent banner component\n */\n\nimport { ConsentConfig, ConsentCategories } from '../types';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class Banner {\n  private config: ConsentConfig;\n  private element: HTMLElement | null = null;\n  private eventEmitter: EventEmitter;\n\n  constructor(config: ConsentConfig, eventEmitter: EventEmitter) {\n    this.config = config;\n    this.eventEmitter = eventEmitter;\n  }\n\n  /**\n   * Show the banner\n   */\n  public show(): void {\n    if (!this.element) {\n      this.element = this.createDOM();\n      document.body.appendChild(this.element);\n      this.attachListeners();\n    }\n\n    // Trigger animation\n    requestAnimationFrame(() => {\n      this.element?.classList.add('is-visible');\n    });\n\n    // Focus first button for accessibility\n    const firstButton = this.element?.querySelector('button');\n    firstButton?.focus();\n\n    // Disable page interaction if configured\n    if (this.config.disablePageInteraction) {\n      document.body.style.overflow = 'hidden';\n    }\n  }\n\n  /**\n   * Hide the banner\n   */\n  public hide(): void {\n    this.element?.classList.remove('is-visible');\n\n    // Re-enable page interaction\n    if (this.config.disablePageInteraction) {\n      document.body.style.overflow = '';\n    }\n\n    setTimeout(() => {\n      this.destroy();\n    }, 300); // Match CSS transition\n  }\n\n  /**\n   * Destroy the banner\n   */\n  public destroy(): void {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n  }\n\n  /**\n   * Create DOM structure for banner\n   */\n  private createDOM(): HTMLElement {\n    const translations = this.config.translations || {};\n    const theme = this.config.theme || 'light';\n    const position = this.config.position || 'bottom';\n    const layout = this.config.layout || 'bar';\n    const backdropBlur = this.config.backdropBlur !== false;\n\n    const template = `\n      <div\n        class=\"cc-banner cc-banner--${position} cc-banner--${layout} ${backdropBlur ? 'cc-backdrop-blur' : ''}\"\n        role=\"region\"\n        aria-label=\"Cookie consent\"\n        aria-live=\"polite\"\n        data-theme=\"${theme}\"\n        style=\"${this.config.primaryColor ? `--cc-primary: ${this.config.primaryColor};` : ''}\"\n      >\n        <div class=\"cc-banner__container\">\n          <div class=\"cc-banner__content\">\n            <h2 class=\"cc-banner__title\">\n              ${translations.title || 'üç™ Nous utilisons des cookies'}\n            </h2>\n            <p class=\"cc-banner__description\">\n              ${this.getDescriptionHTML()}\n            </p>\n          </div>\n          <div class=\"cc-banner__actions\">\n            <button\n              class=\"cc-btn cc-btn--secondary\"\n              data-action=\"reject\"\n              aria-label=\"Rejeter tous les cookies\"\n            >\n              ${translations.rejectAll || 'Tout rejeter'}\n            </button>\n            <button\n              class=\"cc-btn cc-btn--tertiary\"\n              data-action=\"customize\"\n              aria-label=\"Personnaliser les pr√©f√©rences\"\n            >\n              ${translations.customize || 'Personnaliser'}\n            </button>\n            <button\n              class=\"cc-btn cc-btn--primary\"\n              data-action=\"accept\"\n              aria-label=\"Accepter tous les cookies\"\n            >\n              ${translations.acceptAll || 'Tout accepter'}\n            </button>\n          </div>\n        </div>\n      </div>\n    `;\n\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = template.trim();\n    return wrapper.firstChild as HTMLElement;\n  }\n\n  /**\n   * Attach event listeners\n   */\n  private attachListeners(): void {\n    this.element?.addEventListener('click', (e) => {\n      const target = e.target as HTMLElement;\n      const action = target.getAttribute('data-action');\n\n      switch (action) {\n        case 'accept':\n          this.handleAcceptAll();\n          break;\n        case 'reject':\n          this.handleRejectAll();\n          break;\n        case 'customize':\n          this.handleCustomize();\n          break;\n      }\n    });\n\n    // Keyboard support\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape' && this.config.disablePageInteraction) {\n        // Allow ESC to close if page interaction is disabled\n        this.handleRejectAll();\n      }\n    });\n  }\n\n  /**\n   * Handle accept all action\n   */\n  private handleAcceptAll(): void {\n    const allCategories: ConsentCategories = {\n      necessary: true,\n      analytics: true,\n      marketing: true,\n    };\n\n    // Only add preferences if it's configured\n    if (this.config.categories.preferences) {\n      allCategories.preferences = true;\n    }\n\n    this.eventEmitter.emit('consent:accept', allCategories);\n    this.config.onAccept?.(allCategories);\n    this.hide();\n  }\n\n  /**\n   * Handle reject all action\n   */\n  private handleRejectAll(): void {\n    const necessaryOnly: ConsentCategories = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    };\n\n    // Only add preferences if it's configured\n    if (this.config.categories.preferences) {\n      necessaryOnly.preferences = false;\n    }\n\n    this.eventEmitter.emit('consent:reject', necessaryOnly);\n    this.config.onReject?.();\n    this.hide();\n  }\n\n  /**\n   * Handle customize action\n   */\n  private handleCustomize(): void {\n    this.eventEmitter.emit('preferences:show');\n    this.hide();\n  }\n\n  /**\n   * Generate description HTML with privacy policy link\n   */\n  private getDescriptionHTML(): string {\n    const translations = this.config.translations || {};\n    const defaultDescription = 'Pour am√©liorer votre exp√©rience sur notre site, nous utilisons des cookies. Vous pouvez choisir les cookies que vous acceptez.';\n    const description = translations.description || defaultDescription;\n\n    if (translations.privacyPolicyUrl) {\n      const linkLabel = translations.privacyPolicyLabel || 'Politique de confidentialit√©';\n      return `${description} <a href=\"${translations.privacyPolicyUrl}\" target=\"_blank\" rel=\"noopener noreferrer\">${linkLabel}</a>`;\n    }\n\n    return description;\n  }\n}\n","/**\n * PreferenceCenter - Modal for granular cookie preferences\n */\n\nimport { ConsentConfig, ConsentCategories } from '../types';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class PreferenceCenter {\n  private config: ConsentConfig;\n  private element: HTMLElement | null = null;\n  private eventEmitter: EventEmitter;\n  private currentConsent: ConsentCategories;\n\n  constructor(\n    config: ConsentConfig,\n    eventEmitter: EventEmitter,\n    currentConsent: ConsentCategories\n  ) {\n    this.config = config;\n    this.eventEmitter = eventEmitter;\n    this.currentConsent = currentConsent;\n  }\n\n  /**\n   * Show the preference center\n   */\n  public show(): void {\n    if (!this.element) {\n      this.element = this.createDOM();\n      document.body.appendChild(this.element);\n      this.attachListeners();\n    }\n\n    this.element.classList.add('is-visible');\n    this.trapFocus();\n\n    // Prevent body scroll\n    document.body.style.overflow = 'hidden';\n  }\n\n  /**\n   * Hide the preference center\n   */\n  public hide(): void {\n    this.element?.classList.remove('is-visible');\n    document.body.style.overflow = '';\n\n    setTimeout(() => {\n      this.destroy();\n    }, 300);\n  }\n\n  /**\n   * Destroy the preference center\n   */\n  public destroy(): void {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n  }\n\n  /**\n   * Create DOM structure for preference center\n   */\n  private createDOM(): HTMLElement {\n    const translations = this.config.translations || {};\n    const theme = this.config.theme || 'light';\n    const position = this.config.preferencesPosition || 'center';\n\n    const template = `\n      <div\n        class=\"cc-modal cc-modal--${position}\"\n        role=\"dialog\"\n        aria-modal=\"true\"\n        aria-labelledby=\"cc-modal-title\"\n        data-theme=\"${theme}\"\n      >\n        <div class=\"cc-modal__overlay\" data-action=\"close\"></div>\n        <div class=\"cc-modal__content\">\n          <div class=\"cc-modal__header\" style=\"${this.config.primaryColor ? `--cc-primary: ${this.config.primaryColor}; --cc-primary-hover: ${this.adjustColorBrightness(this.config.primaryColor, -15)};` : ''}\">\n            <h2 id=\"cc-modal-title\">\n              ${translations.preferencesTitle || translations.title || 'Pr√©f√©rences de cookies'}\n            </h2>\n            <button\n              class=\"cc-modal__close\"\n              aria-label=\"Fermer\"\n              data-action=\"close\"\n            >\n              <svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n                <path d=\"M18 6L6 18M6 6l12 12\" stroke-width=\"2\" stroke-linecap=\"round\"/>\n              </svg>\n            </button>\n          </div>\n\n          <div class=\"cc-modal__body\">\n            ${this.renderCategories()}\n          </div>\n\n          <div class=\"cc-modal__footer\">\n            <div class=\"cc-modal__footer-links\">\n              ${translations.privacyPolicyUrl ? `\n                <a href=\"${translations.privacyPolicyUrl}\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"cc-privacy-link\">\n                  <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                    <path d=\"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6\"/>\n                    <polyline points=\"15 3 21 3 21 9\"/>\n                    <line x1=\"10\" y1=\"14\" x2=\"21\" y2=\"3\"/>\n                  </svg>\n                  ${translations.privacyPolicyLabel || 'Politique de confidentialit√©'}\n                </a>\n              ` : ''}\n            </div>\n            <div class=\"cc-modal__footer-actions\">\n              <button\n                class=\"cc-btn cc-btn--secondary\"\n                data-action=\"reject\"\n              >\n                ${translations.rejectAll || 'Tout rejeter'}\n              </button>\n              <button\n                class=\"cc-btn cc-btn--primary\"\n                data-action=\"save\"\n              >\n                ${translations.savePreferences || 'Sauvegarder'}\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = template.trim();\n    return wrapper.firstChild as HTMLElement;\n  }\n\n  /**\n   * Render category toggles\n   */\n  private renderCategories(): string {\n    const categories = Object.entries(this.config.categories);\n\n    return categories\n      .map(([key, config]) => {\n        const checked = this.currentConsent[key as keyof ConsentCategories];\n        const disabled = config.readOnly;\n\n        return `\n        <div class=\"cc-category\">\n          <div class=\"cc-category__header\">\n            <label class=\"cc-toggle ${disabled ? 'cc-toggle--disabled' : ''}\">\n              <input\n                type=\"checkbox\"\n                data-category=\"${key}\"\n                ${checked ? 'checked' : ''}\n                ${disabled ? 'disabled' : ''}\n                aria-label=\"${config.label} cookies\"\n              >\n              <span class=\"cc-toggle__slider\"></span>\n            </label>\n            <div class=\"cc-category__info\">\n              <h3>${config.label}</h3>\n              <p>${config.description}</p>\n            </div>\n          </div>\n        </div>\n      `;\n      })\n      .join('');\n  }\n\n  /**\n   * Attach event listeners\n   */\n  private attachListeners(): void {\n    this.element?.addEventListener('click', (e) => {\n      const target = e.target as HTMLElement;\n      const action = target.getAttribute('data-action');\n\n      if (action === 'close') {\n        this.hide();\n      } else if (action === 'save') {\n        this.handleSave();\n      } else if (action === 'reject') {\n        this.handleRejectAll();\n      }\n    });\n\n    // Keyboard shortcuts\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Escape') {\n        this.hide();\n      }\n    });\n  }\n\n  /**\n   * Handle save preferences\n   */\n  private handleSave(): void {\n    const checkboxes = this.element?.querySelectorAll('input[data-category]');\n    const categories: ConsentCategories = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    };\n\n    checkboxes?.forEach((checkbox) => {\n      if (checkbox instanceof HTMLInputElement) {\n        const category = checkbox.getAttribute('data-category');\n        if (category) {\n          categories[category as keyof ConsentCategories] = checkbox.checked;\n        }\n      }\n    });\n\n    this.eventEmitter.emit('consent:update', categories);\n    this.config.onChange?.(categories);\n    this.hide();\n  }\n\n  /**\n   * Handle reject all\n   */\n  private handleRejectAll(): void {\n    const necessaryOnly: ConsentCategories = {\n      necessary: true,\n      analytics: false,\n      marketing: false,\n    };\n\n    // Only add preferences if it's configured\n    if (this.config.categories.preferences) {\n      necessaryOnly.preferences = false;\n    }\n\n    this.eventEmitter.emit('consent:reject', necessaryOnly);\n    this.hide();\n  }\n\n  /**\n   * Trap focus within modal\n   */\n  private trapFocus(): void {\n    const focusableElements = this.element?.querySelectorAll(\n      'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])'\n    );\n\n    if (!focusableElements || focusableElements.length === 0) return;\n\n    const firstFocusable = focusableElements[0] as HTMLElement;\n    const lastFocusable = focusableElements[focusableElements.length - 1] as HTMLElement;\n\n    // Focus first element\n    firstFocusable?.focus();\n\n    // Trap focus\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Tab') {\n        if (e.shiftKey && document.activeElement === firstFocusable) {\n          e.preventDefault();\n          lastFocusable.focus();\n        } else if (!e.shiftKey && document.activeElement === lastFocusable) {\n          e.preventDefault();\n          firstFocusable.focus();\n        }\n      }\n    });\n  }\n\n  /**\n   * Adjust color brightness for hover effect\n   */\n  private adjustColorBrightness(color: string, percent: number): string {\n    // Remove # if present\n    const hex = color.replace('#', '');\n\n    // Convert to RGB\n    const r = parseInt(hex.substring(0, 2), 16);\n    const g = parseInt(hex.substring(2, 4), 16);\n    const b = parseInt(hex.substring(4, 6), 16);\n\n    // Adjust brightness\n    const adjust = (value: number) => {\n      const adjusted = value + (value * percent / 100);\n      return Math.max(0, Math.min(255, Math.round(adjusted)));\n    };\n\n    // Convert back to hex\n    const toHex = (value: number) => {\n      const hex = value.toString(16);\n      return hex.length === 1 ? '0' + hex : hex;\n    };\n\n    return `#${toHex(adjust(r))}${toHex(adjust(g))}${toHex(adjust(b))}`;\n  }\n}\n","/**\n * FloatingWidget - Permanent cookie settings button\n * Stays visible at all times for easy access to preferences\n */\n\nimport { ConsentConfig } from '../types';\nimport { EventEmitter } from '../core/EventEmitter';\n\nexport class FloatingWidget {\n  private config: ConsentConfig;\n  private element: HTMLElement | null = null;\n  private eventEmitter: EventEmitter;\n  private isVisible: boolean = false;\n\n  constructor(config: ConsentConfig, eventEmitter: EventEmitter) {\n    this.config = config;\n    this.eventEmitter = eventEmitter;\n  }\n\n  /**\n   * Show the floating widget\n   */\n  public show(): void {\n    console.log('üéØ FloatingWidget.show() called');\n\n    if (!this.element) {\n      this.element = this.createDOM();\n      document.body.appendChild(this.element);\n      this.attachListeners();\n      console.log('‚úÖ Widget element created and appended to body');\n    }\n\n    // Delay to allow for transition\n    requestAnimationFrame(() => {\n      this.element?.classList.add('is-visible');\n      this.isVisible = true;\n      console.log('‚úÖ Widget is-visible class added');\n    });\n  }\n\n  /**\n   * Hide the floating widget\n   */\n  public hide(): void {\n    this.element?.classList.remove('is-visible');\n    this.isVisible = false;\n  }\n\n  /**\n   * Destroy the widget\n   */\n  public destroy(): void {\n    if (this.element) {\n      this.element.remove();\n      this.element = null;\n    }\n    this.isVisible = false;\n  }\n\n  /**\n   * Check if widget is visible\n   */\n  public getIsVisible(): boolean {\n    return this.isVisible;\n  }\n\n  /**\n   * Create DOM structure for floating widget\n   */\n  private createDOM(): HTMLElement {\n    const translations = this.config.translations || {};\n    const theme = this.config.theme || 'light';\n    const widgetPosition = this.config.widgetPosition || 'bottom-right';\n    const widgetStyle = this.config.widgetStyle || 'full';\n\n    console.log('üç™ Widget config:', { widgetPosition, widgetStyle, configWidgetStyle: this.config.widgetStyle });\n\n    const template = `\n      <div\n        class=\"cc-widget cc-widget--${widgetPosition} cc-widget--${widgetStyle}\"\n        role=\"button\"\n        aria-label=\"${translations.cookieSettings || 'Param√®tres des cookies'}\"\n        tabindex=\"0\"\n        data-theme=\"${theme}\"\n        style=\"${this.config.primaryColor ? `--cc-primary: ${this.config.primaryColor};` : ''}\"\n      >\n        <svg class=\"cc-widget__icon\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n          <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"/>\n          <circle cx=\"12\" cy=\"12\" r=\"2\"/>\n          <circle cx=\"7\" cy=\"7\" r=\"1.5\"/>\n          <circle cx=\"17\" cy=\"7\" r=\"1.5\"/>\n          <circle cx=\"7\" cy=\"17\" r=\"1.5\"/>\n          <circle cx=\"17\" cy=\"17\" r=\"1.5\"/>\n        </svg>\n        <span class=\"cc-widget__text\">\n          ${translations.cookies || 'Cookies'}\n        </span>\n      </div>\n    `;\n\n    const wrapper = document.createElement('div');\n    wrapper.innerHTML = template.trim();\n    return wrapper.firstChild as HTMLElement;\n  }\n\n  /**\n   * Attach event listeners\n   */\n  private attachListeners(): void {\n    this.element?.addEventListener('click', () => {\n      this.handleClick();\n    });\n\n    this.element?.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        this.handleClick();\n      }\n    });\n  }\n\n  /**\n   * Handle widget click\n   */\n  private handleClick(): void {\n    this.eventEmitter.emit('preferences:show');\n  }\n}\n","/**\n * GTMConsentMode - Integration with Google Consent Mode v2\n */\n\nimport { ConsentCategories, GTMConsent } from '../types';\nimport { DataLayerManager } from './DataLayerManager';\n\nexport class GTMConsentMode {\n  private dataLayerManager: DataLayerManager;\n\n  constructor(dataLayerManager: DataLayerManager) {\n    this.dataLayerManager = dataLayerManager;\n  }\n\n  /**\n   * Set default consent state (MUST be called BEFORE GTM loads)\n   */\n  public setDefaultConsent(): void {\n    this.dataLayerManager.push('consent', 'default', {\n      ad_storage: 'denied',\n      ad_user_data: 'denied',\n      ad_personalization: 'denied',\n      analytics_storage: 'denied',\n      functionality_storage: 'denied',\n      personalization_storage: 'denied',\n      security_storage: 'granted', // Always granted\n    });\n  }\n\n  /**\n   * Update consent state based on user choices\n   */\n  public updateConsent(categories: ConsentCategories): void {\n    const gtmConsent = this.mapCategoriesToGTM(categories);\n    this.dataLayerManager.push('consent', 'update', gtmConsent);\n  }\n\n  /**\n   * Map consent categories to GTM Consent Mode v2 format\n   */\n  private mapCategoriesToGTM(categories: ConsentCategories): GTMConsent {\n    return {\n      ad_storage: categories.marketing ? 'granted' : 'denied',\n      ad_user_data: categories.marketing ? 'granted' : 'denied',\n      ad_personalization: categories.marketing ? 'granted' : 'denied',\n      analytics_storage: categories.analytics ? 'granted' : 'denied',\n      functionality_storage: categories.preferences ? 'granted' : 'denied',\n      personalization_storage: categories.preferences ? 'granted' : 'denied',\n      security_storage: 'granted', // Always granted\n    };\n  }\n}\n","/**\n * DataLayerManager - Manages Google Tag Manager dataLayer communication\n */\n\nexport class DataLayerManager {\n  /**\n   * Push data to GTM dataLayer\n   */\n  public push(command: string, action: string, params: any): void {\n    // Initialize dataLayer if it doesn't exist\n    window.dataLayer = window.dataLayer || [];\n\n    // Push to dataLayer\n    window.dataLayer.push({\n      event: 'consent_update',\n      [command]: {\n        [action]: params,\n      },\n    });\n\n    // Also push using gtag format if available\n    if (typeof window.gtag === 'function') {\n      window.gtag(command, action, params);\n    }\n  }\n}\n","/**\n * CookieConsent - Main orchestrator class\n */\n\nimport { ConsentConfig, ConsentCategories } from '../types';\nimport { ConsentManager } from './ConsentManager';\nimport { StorageManager } from './StorageManager';\nimport { EventEmitter } from './EventEmitter';\nimport { ScriptBlocker } from '../blocking/ScriptBlocker';\nimport { CategoryManager } from '../blocking/CategoryManager';\nimport { Banner } from '../ui/Banner';\nimport { PreferenceCenter } from '../ui/PreferenceCenter';\nimport { FloatingWidget } from '../ui/FloatingWidget';\nimport { GTMConsentMode } from '../integrations/GTMConsentMode';\nimport { DataLayerManager } from '../integrations/DataLayerManager';\n\n// Import CSS\nimport '../styles/banner.css';\nimport '../styles/animations.css';\nimport '../styles/preferences.css';\nimport '../styles/widget.css';\n\nexport class CookieConsent {\n  private config: ConsentConfig;\n  private consentManager: ConsentManager;\n  private storageManager: StorageManager;\n  private scriptBlocker: ScriptBlocker;\n  private eventEmitter: EventEmitter;\n  private banner: Banner | null = null;\n  private preferenceCenter: PreferenceCenter | null = null;\n  private floatingWidget: FloatingWidget | null = null;\n  private gtmIntegration: GTMConsentMode | null = null;\n\n  constructor(config: ConsentConfig) {\n    this.config = this.validateConfig(config);\n    this.consentManager = new ConsentManager(this.config);\n    this.storageManager = new StorageManager();\n    this.eventEmitter = new EventEmitter();\n    this.scriptBlocker = new ScriptBlocker(\n      new CategoryManager(),\n      this.eventEmitter\n    );\n\n    if (this.config.gtmConsentMode) {\n      this.gtmIntegration = new GTMConsentMode(new DataLayerManager());\n    }\n\n    // Listen for preference center requests\n    this.eventEmitter.on('preferences:show', () => {\n      this.showPreferences();\n    });\n\n    // Listen for consent updates\n    this.eventEmitter.on('consent:accept', (categories: ConsentCategories) => {\n      this.updateConsent(categories);\n    });\n\n    this.eventEmitter.on('consent:reject', (categories: ConsentCategories) => {\n      this.updateConsent(categories);\n    });\n\n    this.eventEmitter.on('consent:update', (categories: ConsentCategories) => {\n      this.updateConsent(categories);\n    });\n  }\n\n  /**\n   * Initialize the cookie consent system\n   */\n  public init(): void {\n    // 1. Start blocking scripts immediately\n    this.scriptBlocker.init();\n\n    // 2. Set GTM default consent BEFORE checking storage\n    if (this.gtmIntegration) {\n      this.gtmIntegration.setDefaultConsent();\n    }\n\n    // 3. Check for existing consent\n    const storedConsent = this.storageManager.load();\n\n    if (storedConsent && !this.storageManager.isExpired(storedConsent)) {\n      // Valid consent exists\n      if (this.consentManager.needsUpdate(storedConsent)) {\n        // Policy updated, show banner again\n        if (this.config.autoShow) {\n          this.showBanner();\n        }\n      } else {\n        // Apply stored consent\n        this.applyConsent(storedConsent.categories);\n        this.eventEmitter.emit('consent:load', storedConsent);\n\n        // Show floating widget if enabled\n        if (this.config.showWidget) {\n          this.showFloatingWidget();\n        }\n      }\n    } else {\n      // No consent or expired\n      if (this.config.autoShow) {\n        this.showBanner();\n      }\n    }\n\n    this.eventEmitter.emit('consent:init');\n  }\n\n  /**\n   * Show the banner\n   */\n  public show(): void {\n    this.showBanner();\n  }\n\n  /**\n   * Hide the banner\n   */\n  public hide(): void {\n    this.banner?.hide();\n  }\n\n  /**\n   * Show preferences modal\n   */\n  public showPreferences(): void {\n    const currentConsent =\n      this.storageManager.load()?.categories || {\n        necessary: true,\n        analytics: false,\n        marketing: false,\n        preferences: false,\n      };\n\n    // Always recreate to get fresh state from storage\n    if (this.preferenceCenter) {\n      this.preferenceCenter.destroy();\n    }\n\n    this.preferenceCenter = new PreferenceCenter(\n      this.config,\n      this.eventEmitter,\n      currentConsent\n    );\n    this.preferenceCenter.show();\n  }\n\n  /**\n   * Update consent with new categories\n   */\n  public updateConsent(categories: ConsentCategories): void {\n    const consentRecord = this.consentManager.updateConsent(categories);\n    this.storageManager.save(consentRecord);\n    this.applyConsent(categories);\n\n    if (this.gtmIntegration) {\n      this.gtmIntegration.updateConsent(categories);\n    }\n\n    // Show floating widget after consent is given (delay to let banner hide)\n    if (this.config.showWidget) {\n      console.log('‚è≥ Widget will show in 400ms...');\n      setTimeout(() => {\n        console.log('üöÄ Calling showFloatingWidget()');\n        this.showFloatingWidget();\n      }, 400); // Wait for banner hide animation\n    } else {\n      console.log('‚ùå Widget disabled in config');\n    }\n  }\n\n  /**\n   * Get current consent\n   */\n  public getConsent() {\n    return this.storageManager.load();\n  }\n\n  /**\n   * Reset consent (clear stored data and show banner)\n   */\n  public reset(): void {\n    this.storageManager.clear();\n    this.scriptBlocker.block();\n    this.showBanner();\n  }\n\n  /**\n   * Register event handler\n   */\n  public on(event: string, callback: Function): void {\n    this.eventEmitter.on(event, callback);\n  }\n\n  /**\n   * Unregister event handler\n   */\n  public off(event: string, callback: Function): void {\n    this.eventEmitter.off(event, callback);\n  }\n\n  /**\n   * Destroy and cleanup all UI elements\n   */\n  public destroy(): void {\n    this.banner?.destroy();\n    this.banner = null;\n    this.preferenceCenter?.destroy();\n    this.preferenceCenter = null;\n    this.floatingWidget?.destroy();\n    this.floatingWidget = null;\n    this.scriptBlocker?.destroy();\n  }\n\n  /**\n   * Show the banner\n   */\n  private showBanner(): void {\n    if (!this.banner) {\n      this.banner = new Banner(this.config, this.eventEmitter);\n    }\n    this.banner.show();\n    this.eventEmitter.emit('consent:show');\n  }\n\n  /**\n   * Show the floating widget\n   */\n  private showFloatingWidget(): void {\n    if (!this.floatingWidget) {\n      this.floatingWidget = new FloatingWidget(this.config, this.eventEmitter);\n    }\n    this.floatingWidget.show();\n  }\n\n  /**\n   * Apply consent by unblocking scripts\n   */\n  private applyConsent(categories: ConsentCategories): void {\n    this.scriptBlocker.unblock(categories);\n  }\n\n  /**\n   * Validate and set default config values\n   */\n  private validateConfig(config: ConsentConfig): ConsentConfig {\n    return {\n      ...config,\n      mode: config.mode || 'opt-in',\n      autoShow: config.autoShow !== undefined ? config.autoShow : true,\n      revision: config.revision || 1,\n      gtmConsentMode: config.gtmConsentMode || false,\n      disablePageInteraction: config.disablePageInteraction || false,\n      theme: config.theme || 'light',\n      position: config.position || 'bottom',\n      layout: config.layout || 'bar',\n      backdropBlur: config.backdropBlur !== false,\n      animationStyle: config.animationStyle || 'smooth',\n      preferencesPosition: config.preferencesPosition || 'center',\n      showWidget: config.showWidget !== undefined ? config.showWidget : true,\n      widgetPosition: config.widgetPosition || 'bottom-right',\n      widgetStyle: config.widgetStyle || 'full',\n    };\n  }\n}\n"],"names":[],"mappings":"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"}